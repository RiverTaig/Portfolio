
<!doctype html>
<html>
<head>
    <title>Volume Meter Sample</title>
    <style>
        video{
    position: absolute;
    left: 20px;
    top: 20px;
}
#myCanvas{
        position: absolute;
    left: 20px;
    top: 20px;
}
    </style>
    <!-- Include the volume meter component -->
    <script src="assets/js/Sound/volume-meter.js"></script>
    <!-- Include the main app logic -->
    <script src="assets/js/Sound/main.js"></script>
</head>
<body>
    <p>This sample shows how to implement a clip-indicating volume meter in Web Audio, using a ScriptProcessor.  It's necessary to use a ScriptProcessor in order to not miss any clipping samples - otherwise you could implement this using a RealtimeAnalyser to only grab samples when necessary.</p>
    <canvas id="meter" width="500" height="50"></canvas>

    <p>Check out the <a href="http://github.com/cwilso/volume-meter/">source on Github</a>.</p>
    <p>
        The usage is quite easy:
        <pre>var meter = createAudioMeter(audioContext,clipLevel,averaging,clipLag);
audioContext: the AudioContext you're using.
clipLevel: the level (0 to 1) that you would consider "clipping".  Defaults to 0.98.
averaging: how "smoothed" you would like the meter to be over time.  Should be between 0 and less than 1.  Defaults to 0.95.
clipLag: how long you would like the "clipping" indicator to show after clipping has occured, in milliseconds.  Defaults to 750ms.
meter.checkClipping();
returns true if the node has clipped in the last clipLag milliseconds.
meter.shutdown();
used to destroy the node (it's important to disconnect and remove the event handler for any ScriptProcessor).
</pre>

        <video id="video" width="640" height="480" autoplay></video>
        <button id="snap">Snap Photo</button>
        <canvas id="canvas" width="640" height="480"></canvas>
        <canvas id="myCanvas" width="640" height="480"></canvas>
<script>
    //var canvas = document.getElementById('canvas');
    //var context = canvas.getContext('2d');
    var video = document.getElementById('video')

    // Get access to the camera!
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        // Not adding `{ audio: true }` since we only want video now
        navigator.mediaDevices.getUserMedia({ video: true }).then(function (stream) {
            video.src = window.URL.createObjectURL(stream);
            video.play();
        });
        document.getElementById("snap").addEventListener("click", function () {
            var canvas = document.getElementById('canvas');
            var context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, 640, 480);
        });
    }

  
</script>
</body>
</html>
